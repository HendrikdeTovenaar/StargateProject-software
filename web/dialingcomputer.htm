<html>
    <head>
        <!-- Chevrons from Manz: https://codepen.io/manz/pen/zoREJL -->
        <meta charset="UTF-8"> 
        <title>Stargate Command</title>
        <link rel="stylesheet" href="main.css" />
        <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico"/>
    </head>
    <body>
        <div id="presets">
            <!-- This div will be populated with entries from the API-sourced AddressBook -->
        </div>
       
    	<div class="controls">
        	<div class="control" onclick="window.location = 'index.htm';">
                Dialing page
            </div>
        </div>

        <script type="text/javascript" src="lib/jquery-3.3.1.min.js"></script>
        <script type="text/javascript">
            
        $.ajax({
            dataType: "json",
            url: "/stargate/get",
            data: {
                entity: "all_gates"
            },
            success: function( json ) {
                console.log( "JSON Data: " + json );
                addresses = json
                load_address_book()
            }
        });
        
        function load_address_book(){
            $.each(addresses, function( index, value ) {
                address_raw = value.gate_address
                address_string = address_raw.join("-");
                $.each(address_raw, function( index, value) {
                    value=("000" + value).substr(-3,3);
                    address_raw[index] = '<img src="chevrons/'+value+'.svg" />';
                });
                address = address_raw.join("");

                fan_gate_string = ""
                if (value.ip_address){
                    fan_gate_string = "(FAN)"
                }
                $("#presets").append('<div class="presetAddress" onclick="window.location = \'index.htm?address=' + address_string + '\';"><div class="name">' + value.name + ' ' + fan_gate_string + '</div><div class="glyphs">' + address +  '</div></div>' );
            });
        }
        </script>
    </body>
</html>
